(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84162,       2328]
NotebookOptionsPosition[     77062,       2201]
NotebookOutlinePosition[     77538,       2219]
CellTagsIndexPosition[     77495,       2216]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Cosmology Toolkit", "Title",
 CellChangeTimes->{{3.9158816405545917`*^9, 3.9158816420910916`*^9}, {
  3.915893349767639*^9, 3.915893351202422*^9}, {3.925358414652584*^9, 
  3.925358419471649*^9}, {3.9506531506292405`*^9, 
  3.9506531576101303`*^9}},ExpressionUUID->"3809e8e0-57dd-4b26-9013-\
38f376e2f55f"],

Cell[CellGroupData[{

Cell["I. GR Tools", "Section",
 CellChangeTimes->{{3.9506578847201943`*^9, 
  3.950657914193551*^9}},ExpressionUUID->"d8e8aff3-e99d-4b81-bf97-\
6ac4982bc74d"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.9506579995076585`*^9, 3.950658020615902*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"dc4cbbc2-31da-44ce-ad21-9f5073e17192"],

Cell["For full-blown curvature quantities", "Text",
 CellChangeTimes->{{3.951272340121393*^9, 3.951272350169123*^9}, 
   3.95127792021263*^9},ExpressionUUID->"4fe643eb-85ba-424d-b768-\
ad7d0d0584d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DiffGeom", "[", 
   RowBox[{"Met_", ",", "Coords_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Dim", ",", "Metric", ",", "InvMet", ",", "Christoff", ",", "Curv", ",", 
      "Ric", ",", "ScalRic", ",", "EinsTens"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Metric", "=", "Met"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Dim", "=", 
      RowBox[{"Length", "[", "Coords", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"InvMet", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Inverse", "[", "Met", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Christoff", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"InvMet", "[", 
              RowBox[{"[", 
               RowBox[{"\[Sigma]", ",", "\[Mu]"}], "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Met", "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Mu]", ",", "\[Beta]"}], "]"}], "]"}], ",", 
                 RowBox[{"Coords", "[", 
                  RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "+", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Met", "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Mu]", ",", "\[Alpha]"}], "]"}], "]"}], ",", 
                 RowBox[{"Coords", "[", 
                  RowBox[{"[", "\[Beta]", "]"}], "]"}]}], "]"}], "-", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Met", "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], ",", 
                 RowBox[{"Coords", "[", 
                  RowBox[{"[", "\[Mu]", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Mu]", ",", "1", ",", "Dim"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Sigma]", ",", "1", ",", "Dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "Dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Beta]", ",", "1", ",", "Dim"}], "}"}]}], "]"}], "//", 
       "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Curv", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Christoff", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j", ",", "l"}], "]"}], "]"}], ",", 
            RowBox[{"Coords", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "-", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Christoff", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
            RowBox[{"Coords", "[", 
             RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Christoff", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "j", ",", "l"}], "]"}], "]"}], " ", 
              RowBox[{"Christoff", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "s", ",", "k"}], "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"Christoff", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "j", ",", "k"}], "]"}], "]"}], " ", 
              RowBox[{"Christoff", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "s", ",", "l"}], "]"}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"s", ",", "1", ",", "Dim"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "Dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "Dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "Dim"}], "}"}]}], "]"}], "//", 
       "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ric", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Curv", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "i", ",", "l"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "Dim"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "Dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "Dim"}], "}"}]}], "]"}], "//", 
       "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ScalRic", "=", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"InvMet", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", 
          RowBox[{"Ric", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "Dim"}], "}"}]}], "]"}], "//", 
       "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"EinsTens", "=", 
      RowBox[{"Ric", "-", 
       RowBox[{
        FractionBox["1", "2"], "ScalRic", "*", "Met"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Christoffel\>\"", "->", "Christoff"}], ",", 
       RowBox[{"\"\<Riemann\>\"", "->", "Curv"}], ",", 
       RowBox[{"\"\<Ricci\>\"", "->", "Ric"}], ",", 
       RowBox[{"\"\<ScalarRic\>\"", "->", "ScalRic"}], ",", 
       RowBox[{"\"\<Einstein\>\"", "->", "EinsTens"}]}], "|>"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9506579236478205`*^9, 3.9506579390090494`*^9}, {
   3.9506580287237763`*^9, 3.9506580289432516`*^9}, {3.9510162459107437`*^9, 
   3.9510162853601975`*^9}, {3.951016503611042*^9, 3.9510165251165037`*^9}, 
   3.951268136202739*^9, {3.951272130069311*^9, 3.9512722283498697`*^9}, {
   3.951272288518876*^9, 3.951272296979701*^9}, {3.9533428620665255`*^9, 
   3.95334295240878*^9}, {3.9533429880277123`*^9, 3.9533429894885454`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"2d5fad5e-fb27-43d9-9cde-d25daf209557"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MetBG", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"K", "[", "r", "]"}], 
         SuperscriptBox["r", "2"]}]}]], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], 
       SuperscriptBox["r", "2"]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], 
       SuperscriptBox["r", "2"], 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InvMetBG", " ", "=", " ", 
   RowBox[{"MetBG", "//", "Inverse"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dim", "=", "4"}], ";"}]}], "Input",
 CellChangeTimes->{{3.953342791174863*^9, 3.95334282394379*^9}, {
  3.9533430445799384`*^9, 3.953343046149526*^9}, {3.953343218727298*^9, 
  3.9533432296431007`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"a1d9e19e-4511-4b10-8462-1ebc5efee8e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GMN", "=", 
    RowBox[{
     RowBox[{"DiffGeom", "[", 
      RowBox[{"MetBG", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], 
      "]"}], "[", "\"\<Einstein\>\"", "]"}]}], ";"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.9531743438438044`*^9, 3.953174380984066*^9}, {
  3.953176120511629*^9, 3.9531761275611067`*^9}, {3.953176537786273*^9, 
  3.953176542278694*^9}, {3.953176606188808*^9, 3.9531766074962006`*^9}, {
  3.9531769473498464`*^9, 3.95317695142655*^9}, {3.953179972841078*^9, 
  3.953180007720838*^9}, {3.9531844237709303`*^9, 3.9531844574510894`*^9}, {
  3.9533427475011697`*^9, 3.9533427557562556`*^9}, {3.9533428137642064`*^9, 
  3.953342815639591*^9}, {3.953342957875716*^9, 3.9533429703260145`*^9}, {
  3.9533430015642776`*^9, 3.953343003747651*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"393e295e-c8aa-49d7-83eb-4983f5bf2987"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MixStressTens", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"\[Rho]", "[", "t", "]"}]}], ",", 
      RowBox[{"w", " ", 
       RowBox[{"\[Rho]", "[", "t", "]"}]}], ",", 
      RowBox[{"w", " ", 
       RowBox[{"\[Rho]", "[", "t", "]"}]}], ",", 
      RowBox[{"w", " ", 
       RowBox[{"\[Rho]", "[", "t", "]"}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StressTens", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MetBG", "\[LeftDoubleBracket]", 
         RowBox[{"\[Mu]", ",", "\[Alpha]"}], "\[RightDoubleBracket]"}], 
        RowBox[{"MixStressTens", "\[LeftDoubleBracket]", 
         RowBox[{"\[Alpha]", ",", "\[Nu]"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Mu]", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Nu]", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GMN", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "==", 
    RowBox[{"8", "\[Pi]", " ", 
     RowBox[{"StressTens", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], "//", 
   "Simplify"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9533427718730383`*^9, 3.9533427748679504`*^9}, {
  3.953342830231453*^9, 3.9533428496709085`*^9}, {3.953342974166335*^9, 
  3.9533429769934764`*^9}, {3.953343009791417*^9, 3.9533431096406264`*^9}, {
  3.953343146352869*^9, 3.953343147497283*^9}, {3.9533431831400614`*^9, 
  3.953343188847639*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"574e76b8-c3b5-44d3-b871-c8ef4e8156ca"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"3", " ", 
     RowBox[{"K", "[", "r", "]"}]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["a", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
    RowBox[{"r", " ", 
     RowBox[{
      SuperscriptBox["K", "\[Prime]",
       MultilineFunction->None], "[", "r", "]"}]}]}], 
   SuperscriptBox[
    RowBox[{"a", "[", "t", "]"}], "2"]], "\[Equal]", 
  RowBox[{"8", " ", "\[Pi]", " ", 
   RowBox[{"\[Rho]", "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.9533430886818104`*^9, 3.9533431099604588`*^9}, 
   3.9533431482948837`*^9, 3.9533431895160666`*^9, 3.9533432320755234`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"efd8c6c4-cf09-4b0e-863b-6f8a5f3c8aa1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GMN", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "==", 
    RowBox[{"8", "\[Pi]", " ", 
     RowBox[{"StressTens", "\[LeftDoubleBracket]", 
      RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "/.", 
   RowBox[{"K", "->", 
    RowBox[{"Function", "[", 
     RowBox[{"r", ",", "0"}], "]"}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.9533431593763165`*^9, 3.9533431963542676`*^9}, {
  3.953343899729595*^9, 3.95334390734573*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"9dd3f63a-05a6-4b55-b8c0-bca46b1714ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"8", " ", "\[Pi]", " ", "w", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "t", "]"}], "2"], " ", 
    RowBox[{"\[Rho]", "[", "t", "]"}]}], "+", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["a", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["a", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "\[Equal]", "0"}]], \
"Input",
 CellChangeTimes->{{3.9533439143703675`*^9, 
  3.9533439151709175`*^9}},ExpressionUUID->"26173ebc-cdf5-47a0-98fd-\
6a2ce9336029"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"8", " ", "\[Pi]", " ", "w", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"\[Rho]", "[", "t", "]"}]}], "+", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["a", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
      RowBox[{"2", " ", 
       RowBox[{"a", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["a", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], "\[Equal]", "0"}], 
    ",", 
    RowBox[{
     RowBox[{"a", "''"}], "[", "t", "]"}]}], "]"}], "//", "Expand"}]], "Input",
 CellChangeTimes->{{3.9533439165347757`*^9, 3.953343932602734*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"24a8ec03-00cd-44b7-ae52-c80f1d944b7d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SuperscriptBox["a", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", "\[Pi]", " ", "w", " ", 
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["a", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"a", "[", "t", "]"}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.953343921607934*^9, 3.953343932802473*^9}},
 CellLabel->"Out[50]=",ExpressionUUID->"1dd908f5-5ad0-445b-b459-d1526f89ff19"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cosh", "[", "x", "]"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"Sinh", "[", "x", "]"}], "2"]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.953175511564398*^9, 3.9531755513197603`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"e4584307-7681-4c95-a786-7dd131a4be4c"],

Cell[BoxData[
 RowBox[{"Cosh", "[", 
  RowBox[{"2", " ", "x"}], "]"}]], "Output",
 CellChangeTimes->{{3.953175519075757*^9, 3.95317555165304*^9}},
 CellLabel->"Out[6]=",ExpressionUUID->"8fa5b598-c87c-4f75-8c61-a0768baeab26"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Coth", "[", "x", "]"}], ",", "x"}], "]"}], "//", 
  "TrigReduce"}]], "Input",
 CellChangeTimes->{{3.9531755716712523`*^9, 3.95317559735244*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"588df999-734e-434f-8258-962fb5b61a19"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["2", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Cosh", "[", 
     RowBox[{"2", " ", "x"}], "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.953175576916649*^9, 3.9531755976768036`*^9}},
 CellLabel->"Out[8]=",ExpressionUUID->"763f961c-e4cd-4e51-87b6-73bde969b718"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cosh", "[", "x", "]"}], "2"], "-", 
   RowBox[{"Cosh", "[", 
    RowBox[{"2", "x"}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.9531759531249704`*^9, 3.9531759642745047`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"49804909-3ecf-4246-9df1-8ffc412df8d1"],

Cell[BoxData[
 RowBox[{"-", 
  SuperscriptBox[
   RowBox[{"Sinh", "[", "x", "]"}], "2"]}]], "Output",
 CellChangeTimes->{3.9531759645901713`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"e75dc144-75c8-48f1-841b-a09dd1f5b3a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"Coth", "[", "x", "]"}], "2"], "-", 
   SuperscriptBox[
    RowBox[{"Csch", "[", "x", "]"}], "2"]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.953176035258252*^9, 3.9531760482790117`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"688701b2-0545-4fad-a82c-0637cd31a761"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.953176048558344*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"f367716d-2d69-42d1-b458-28602bad66d8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"CurvatureComputations", "[", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       SuperscriptBox[
        RowBox[{"Sinh", "[", "\[Chi]", "]"}], "2"]}], "}"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Chi]", ",", "\[Phi]"}], "}"}]}], "]"}], "[", 
  "\"\<ChristoffelSymbols\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.952555656867364*^9, 3.9525557096870594`*^9}, {
  3.952557520052777*^9, 3.9525575446697435`*^9}, {3.9527656163119926`*^9, 
  3.952765645226449*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"33c76fbe-4487-4750-a886-c678f7307425"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cosh", "[", "\[Chi]", "]"}]}], " ", 
        RowBox[{"Sinh", "[", "\[Chi]", "]"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Coth", "[", "\[Chi]", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Coth", "[", "\[Chi]", "]"}], ",", "0"}], "}"}]}], "}"}]}], 
  "}"}]], "Input",
 CellChangeTimes->{3.952765656307212*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"db2213db-fd7e-4fcd-b422-baceb060ebfb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CurvatureComputations", "[", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       SuperscriptBox[
        RowBox[{"Sinh", "[", "\[Chi]", "]"}], "2"]}], "}"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Chi]", ",", "\[Phi]"}], "}"}]}], "]"}], "[", 
  "\"\<RiemannTensor\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.952765660910388*^9, 3.9527656629608455`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"294812fc-71cd-4a2d-ae96-a69cb2a0f75b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"Sinh", "[", "\[Chi]", "]"}], "2"]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Sinh", "[", "\[Chi]", "]"}], "2"], ",", "0"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.952765663411281*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"64f47890-b19b-4181-9b74-a235a4bda5d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CurvatureComputations", "[", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", "m", " ", "g", " ", "y"}]}], ")"}]}], ",", "1", ",", 
       "1", ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}], "]"}], "[", 
  "\"\<RiemannTensor\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.952557584895982*^9, 3.952557590192813*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"177315bd-852a-4cf1-a0c3-09c81cd4fe25"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         FractionBox[
          RowBox[{
           SuperscriptBox["g", "2"], " ", 
           SuperscriptBox["m", "2"]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "g", " ", "m", " ", "y"}]}], ")"}], "2"]], ",",
          "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["m", "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"2", " ", "g", " ", "m", " ", "y"}]}], ")"}], "2"]]}], 
         ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         FractionBox[
          RowBox[{
           SuperscriptBox["g", "2"], " ", 
           SuperscriptBox["m", "2"]}], 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "g", " ", "m", " ", "y"}]}]], ",", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["m", "2"]}], 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "g", " ", "m", " ", "y"}]}]]}], ",", "0", ",", 
         "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9525575904895973`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"2c4298e9-c894-4f7a-9114-9f147eb0323f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CurvatureComputations", "[", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["r", "2"], ",", 
        RowBox[{
         SuperscriptBox["r", "2"], 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], "]"}], "[", 
   "\"\<RiemannTensor\>\"", "]"}], "\[LeftDoubleBracket]", 
  RowBox[{"1", ",", "2", ",", "1", ",", "2"}], 
  "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.953106361523249*^9, 3.9531064028647976`*^9}, {
  3.953107922782613*^9, 3.9531079252267323`*^9}, {3.9531087899313793`*^9, 
  3.9531087946646323`*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"ce191f4f-9dbe-4706-8cc5-e4ad2ea12483"],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]], "Output",
 CellChangeTimes->{{3.9531063888334684`*^9, 3.953106403177307*^9}, 
   3.953107925830366*^9, 3.953108795107995*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"91306234-84c0-4259-82f6-0b84d860e434"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"Cot", "[", "\[Theta]", "]"}], ",", "\[Theta]"}], "]"}]], "Input",
 CellChangeTimes->{{3.95310805869905*^9, 3.9531080640238175`*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"99454417-24e1-4a22-acb1-d8d77cb70fb0"],

Cell[BoxData[
 RowBox[{"-", 
  SuperscriptBox[
   RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}]], "Output",
 CellChangeTimes->{3.9531080645825005`*^9},
 CellLabel->
  "Out[109]=",ExpressionUUID->"304cec1c-ef50-4b50-a8fa-f1fed969f834"]
}, Open  ]],

Cell[TextData[{
 "For curvature quantities expanded up to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", 
    SuperscriptBox["\[Epsilon]", "N"], ")"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "84471bc1-24b8-434a-b099-c0437e162e04"],
 ", we use the following module:"
}], "Text",
 CellChangeTimes->{{3.9512722989127307`*^9, 
  3.951272334047104*^9}},ExpressionUUID->"4589ba25-46a8-4647-ab71-\
05984bf51536"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PerturbedCurvature", "[", 
   RowBox[{"Met_", ",", "Coords_", ",", "Order_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Dim", ",", "Metric", ",", "InvMet", ",", "Christoff", ",", "Curv", ",", 
      "Ric", ",", "ScalRic"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Metric", "=", "Met"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Dim", "=", 
      RowBox[{"Length", "[", "Coords", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"InvMet", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Inverse", "[", "Met", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Christoff", "=", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "2"}], " ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"InvMet", "[", 
                 RowBox[{"[", 
                  RowBox[{"\[Sigma]", ",", "\[Mu]"}], "]"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"Met", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Mu]", ",", "\[Beta]"}], "]"}], "]"}], ",", 
                    RowBox[{"Coords", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "+", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"Met", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Mu]", ",", "\[Alpha]"}], "]"}], "]"}], ",", 
                    RowBox[{"Coords", "[", 
                    RowBox[{"[", "\[Beta]", "]"}], "]"}]}], "]"}], "-", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"Met", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], ",", 
                    RowBox[{"Coords", "[", 
                    RowBox[{"[", "\[Mu]", "]"}], "]"}]}], "]"}]}], ")"}]}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"\[Mu]", ",", "1", ",", "Dim"}], "}"}]}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"\[Sigma]", ",", "1", ",", "Dim"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "1", ",", "Dim"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Beta]", ",", "1", ",", "Dim"}], "}"}]}], "]"}], "//", 
          "Simplify"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "Order"}], "}"}]}], "]"}], "//",
        "Normal"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Curv", "=", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"Christoff", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "l"}], "]"}], "]"}], ",", 
              RowBox[{"Coords", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"Christoff", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"Coords", "[", 
               RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "+", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Christoff", "[", 
                 RowBox[{"[", 
                  RowBox[{"s", ",", "j", ",", "l"}], "]"}], "]"}], " ", 
                RowBox[{"Christoff", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "s", ",", "k"}], "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"Christoff", "[", 
                 RowBox[{"[", 
                  RowBox[{"s", ",", "j", ",", "k"}], "]"}], "]"}], " ", 
                RowBox[{"Christoff", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "s", ",", "l"}], "]"}], "]"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"s", ",", "1", ",", "Dim"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "Dim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "Dim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "Dim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "1", ",", "Dim"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "Order"}], "}"}]}], "]"}], "//",
        "Normal"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ric", "=", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"Curv", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "i", ",", "l"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "Dim"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "Dim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "1", ",", "Dim"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "Order"}], "}"}]}], "]"}], "//",
        "Normal"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ScalRic", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"InvMet", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", 
             RowBox[{"Ric", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "Dim"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "Dim"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Epsilon]", ",", "0", ",", "Order"}], "}"}]}], "]"}], "//",
         "Normal"}], "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Metric\>\"", "->", "Metric"}], ",", 
       RowBox[{"\"\<InverseMetric\>\"", "->", "InvMet"}], ",", 
       RowBox[{"\"\<ChristoffelSymbols\>\"", "->", "Christoff"}], ",", 
       RowBox[{"\"\<RiemannTensor\>\"", "->", "Curv"}], ",", 
       RowBox[{"\"\<RicciTensor\>\"", "->", "Ric"}], ",", 
       RowBox[{"\"\<ScalarCurvature\>\"", "->", "ScalRic"}]}], "|>"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9512756057086782`*^9, 3.9512756107841206`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"07692e3d-b406-4d1d-9d44-b004b22dfefb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CurvatureComputations", "[", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "}"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], "]"}], "[", 
  "\"\<ChristoffelSymbols\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.9524000136863422`*^9, 3.9524000658114505`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"a7fd4425-369f-46a0-9d8e-30c861747440"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Cot", "[", "\[Theta]", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cot", "[", "\[Theta]", "]"}], ",", "0"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.9524000408118343`*^9, 3.952400066102517*^9}},
 CellLabel->"Out[54]=",ExpressionUUID->"9fe04142-228a-4946-9510-9a7a1788a32b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["II.  Scalar Perturbations", "Section",
 CellChangeTimes->{{3.9506581730482197`*^9, 3.9506581882873154`*^9}, {
  3.9512723698492336`*^9, 
  3.951272373076559*^9}},ExpressionUUID->"792db1c6-1570-4888-9e66-\
ca8db693bd98"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Coords", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Met", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", "\[Epsilon]", " ", 
            RowBox[{"C", "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
           RowBox[{
            FractionBox["2", "3"], "\[Epsilon]", " ", 
            RowBox[{"Laplacian", "[", 
             RowBox[{
              RowBox[{"\[CapitalEpsilon]", "[", 
               RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "Coords"}], 
             "]"}]}]}], ")"}], 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"i", ",", "j"}], "]"}]}], "+", 
        RowBox[{"2", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"\[Epsilon]", " ", 
              RowBox[{"\[CapitalEpsilon]", "[", 
               RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
             RowBox[{
             "Coords", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}], "]"}], ",", 
           RowBox[{
           "Coords", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
           "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Met", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.9512678759855485`*^9, 3.951268022228322*^9}, {
   3.951268225997279*^9, 3.9512682276837234`*^9}, {3.9512689240964146`*^9, 
   3.951269012541601*^9}, {3.9512695554726896`*^9, 3.9512696348175163`*^9}, {
   3.951269669849096*^9, 3.9512696878676615`*^9}, {3.951270683913165*^9, 
   3.9512707035443244`*^9}, {3.951270890014124*^9, 3.9512708997030544`*^9}, {
   3.9512712526829576`*^9, 3.951271256014741*^9}, {3.9512713515930557`*^9, 
   3.9512713893500333`*^9}, {3.95127148190153*^9, 3.951271482995021*^9}, {
   3.9512723897146635`*^9, 3.951272401789083*^9}, {3.9512754420540867`*^9, 
   3.9512755213912125`*^9}, {3.9512756765987444`*^9, 
   3.9512756784399796`*^9}, {3.9512761984956207`*^9, 3.951276227059444*^9}, 
   3.9512766417674055`*^9, {3.9512766930302444`*^9, 3.9512766932194686`*^9}, {
   3.951276897832077*^9, 3.9512768999082365`*^9}, {3.9512774566118035`*^9, 
   3.9512775249274516`*^9}, {3.9512776222551823`*^9, 3.9512776270484*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"77b42885-5dbc-432a-9838-2a0e5f886a7e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{"C", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{
           SuperscriptBox["\[CapitalEpsilon]", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
         RowBox[{
          FractionBox["2", "3"], " ", "\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "0", ",", "2"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "2", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"2", ",", "0", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]},
     {
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{"C", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{
           SuperscriptBox["\[CapitalEpsilon]", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
         RowBox[{
          FractionBox["2", "3"], " ", "\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "0", ",", "2"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "2", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"2", ",", "0", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]},
     {
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{"C", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{
           SuperscriptBox["\[CapitalEpsilon]", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
         RowBox[{
          FractionBox["2", "3"], " ", "\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "0", ",", "2"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "2", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"2", ",", "0", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ")"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9512724238389378`*^9, {3.9512754995724063`*^9, 3.9512755217977777`*^9}, 
   3.9512756201627884`*^9, 3.9512756795037885`*^9, 3.9512759811883326`*^9, 
   3.951276098168895*^9, {3.9512762024600134`*^9, 3.95127622744137*^9}, {
   3.951276645998161*^9, 3.951276670449132*^9}, 3.9512767013537765`*^9, 
   3.9512769007704625`*^9, 3.9512775256139445`*^9, 3.951277572219057*^9, 
   3.9512776274597816`*^9, 3.951277855538099*^9, 3.9513375530592637`*^9},
 CellLabel->
  "Out[9]//MatrixForm=",ExpressionUUID->"e45e9453-02b1-4210-b052-\
06bcc0deee89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PerturbedCurvature", "[", 
    RowBox[{"Met", ",", "Coords", ",", "1"}], "]"}], "[", 
   "\"\<ScalarCurvature\>\"", "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.951277535294801*^9, 3.9512775424325647`*^9}, {
  3.951277594924122*^9, 3.9512776149703856`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"b79533e2-72b9-4f6a-9cdc-8572c29a5ed2"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"4", " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", 
       RowBox[{
        SuperscriptBox["C", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "2"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[CapitalEpsilon]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "4"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
      RowBox[{"3", " ", 
       RowBox[{
        SuperscriptBox["C", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2", ",", "2"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[CapitalEpsilon]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "4", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
      RowBox[{"3", " ", 
       RowBox[{
        SuperscriptBox["C", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0", ",", "2"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[CapitalEpsilon]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"4", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ")"}]}], 
   RowBox[{"3", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "t", "]"}], "2"]}]]}]], "Output",
 CellChangeTimes->{{3.951277557763446*^9, 3.951277632380413*^9}, 
   3.951277859340675*^9, 3.9513375650555916`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"ebf0d4a2-ec73-4f46-ba03-686ede5e1b47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Coords", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Met", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], 
      RowBox[{"(", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", "\[Epsilon]", " ", 
             RowBox[{"\[Zeta]", "[", 
              RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ")"}], 
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}], "+", 
         RowBox[{"2", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", " ", 
               RowBox[{"F", "[", 
                RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
              RowBox[{
              "Coords", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", 
            RowBox[{
            "Coords", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}]}], "]"}]}]}], ")"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Met", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.9512678759855485`*^9, 3.951268022228322*^9}, {
   3.951268225997279*^9, 3.9512682276837234`*^9}, {3.9512689240964146`*^9, 
   3.951269012541601*^9}, {3.9512695554726896`*^9, 3.9512696348175163`*^9}, {
   3.951269669849096*^9, 3.9512696878676615`*^9}, {3.951270683913165*^9, 
   3.9512707035443244`*^9}, {3.951270890014124*^9, 3.9512708997030544`*^9}, {
   3.9512712526829576`*^9, 3.951271256014741*^9}, {3.9512713515930557`*^9, 
   3.9512713893500333`*^9}, {3.95127148190153*^9, 3.951271482995021*^9}, {
   3.9512723897146635`*^9, 3.951272401789083*^9}, {3.9512754420540867`*^9, 
   3.9512755213912125`*^9}, {3.9512756765987444`*^9, 
   3.9512756784399796`*^9}, {3.9512761984956207`*^9, 3.951276227059444*^9}, 
   3.9512766417674055`*^9, {3.9512766930302444`*^9, 3.9512766932194686`*^9}, {
   3.951276897832077*^9, 3.9512768999082365`*^9}, {3.9512774566118035`*^9, 
   3.9512775249274516`*^9}, {3.9512776222551823`*^9, 
   3.9512776578208523`*^9}, {3.951277698524556*^9, 3.951277736591169*^9}, {
   3.9512778761736684`*^9, 3.951277876513246*^9}, {3.9512779866961813`*^9, 
   3.9512779869147463`*^9}, {3.951278376929799*^9, 3.951278387294264*^9}, {
   3.9512784881433587`*^9, 3.951278488394503*^9}, {3.9512795603938026`*^9, 
   3.9512795770730314`*^9}, {3.9513375296497345`*^9, 3.9513375304245644`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"3b9b7b36-4e3c-4a0d-a046-90a3d8d1ee5f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{"\[Zeta]", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{
           SuperscriptBox["F", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["F", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["F", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]},
     {
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["F", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{"\[Zeta]", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{
           SuperscriptBox["F", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["F", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]},
     {
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["F", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["F", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{"\[Zeta]", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{
           SuperscriptBox["F", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.951278388081688*^9, 3.951278488997525*^9, {3.9512795663258953`*^9, 
   3.951279577292489*^9}, {3.951337544151431*^9, 3.951337565265086*^9}},
 CellLabel->
  "Out[13]//MatrixForm=",ExpressionUUID->"5674dbb4-f3cd-4900-a9be-\
2f31927ab918"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PerturbedCurvature", "[", 
    RowBox[{"Met", ",", "Coords", ",", "1"}], "]"}], "[", 
   "\"\<ScalarCurvature\>\"", "]"}], "//", "Simplify"}]], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"a5d95d35-5774-4bf8-8a9e-7127bdecb070"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"4", " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Zeta]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["\[Zeta]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["\[Zeta]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"a", "[", "t", "]"}], "2"]]}]], "Output",
 CellChangeTimes->{3.951277977816276*^9, 3.9512780317574763`*^9, 
  3.9512783992559133`*^9, 3.9512784927189255`*^9, 3.9512795978586426`*^9, 
  3.9513375673346753`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"2ac96fd8-4791-445b-b880-10f23bc4b078"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CurvatureComputations", "[", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"], 
         RowBox[{"1", "-", 
          RowBox[{"K", " ", 
           SuperscriptBox["r", "2"]}]}]], ",", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"], 
         SuperscriptBox["r", "2"]}], ",", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"], 
         SuperscriptBox["r", "2"], 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], "]"}], "[", 
   "\"\<ScalarCurvature\>\"", "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.9512804443798804`*^9, 3.9512805427366734`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"91a8d7e2-a40c-4512-88dc-67327032eb43"],

Cell[BoxData[
 FractionBox[
  RowBox[{"6", " ", "K"}], 
  SuperscriptBox[
   RowBox[{"a", "[", "t", "]"}], "2"]]], "Output",
 CellChangeTimes->{{3.9512805033127055`*^9, 3.951280556828993*^9}, 
   3.9513375675844007`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"23d6aeea-ad98-4893-8e71-9320cbe9dff4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CurvatureComputations", "[", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"B", "[", "r", "]"}], "2"], ",", 
        SuperscriptBox[
         RowBox[{"R", "[", "r", "]"}], "2"], ",", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"R", "[", "r", "]"}], "2"], 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], "]"}], "[", 
   "\"\<ScalarCurvature\>\"", "]"}], "//", "Expand"}]], "Input",
 CellChangeTimes->{{3.951435474328821*^9, 3.951435560960052*^9}, {
  3.951435609449248*^9, 3.951435620732537*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"d0acfae9-b31a-482f-bd7d-1dd646277dc9"],

Cell[BoxData[
 RowBox[{
  FractionBox["2", 
   SuperscriptBox[
    RowBox[{"R", "[", "r", "]"}], "2"]], "+", 
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{
     SuperscriptBox["B", "\[Prime]",
      MultilineFunction->None], "[", "r", "]"}], " ", 
    RowBox[{
     SuperscriptBox["R", "\[Prime]",
      MultilineFunction->None], "[", "r", "]"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"B", "[", "r", "]"}], "3"], " ", 
    RowBox[{"R", "[", "r", "]"}]}]], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["R", "\[Prime]",
       MultilineFunction->None], "[", "r", "]"}], "2"]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"B", "[", "r", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"R", "[", "r", "]"}], "2"]}]], "-", 
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{
     SuperscriptBox["R", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "r", "]"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"B", "[", "r", "]"}], "2"], " ", 
    RowBox[{"R", "[", "r", "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.9514355328151436`*^9, 3.9514355611319065`*^9}, 
   3.951435628639578*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"8ea370f8-17ef-4f93-88a3-460872c8e0ba"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"H", "[", "t", "]"}], 
    RowBox[{"a", "[", "t", "]"}], "r", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], "Rb"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], "Ub"}]}], ")"}]}], "]"}], "==", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], "Ab"}]}], ")"}]}], 
   RowBox[{"(", 
    FractionBox["w", 
     RowBox[{"1", "+", "w"}]], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.9514412946122046`*^9, 
  3.9514413671417418`*^9}},ExpressionUUID->"1388bbce-3765-49fa-88b4-\
f55c4463fbdf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Met", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"A", "[", 
        RowBox[{"t", ",", "r"}], "]"}], "2"], ",", 
      SuperscriptBox[
       RowBox[{"B", "[", 
        RowBox[{"t", ",", "r"}], "]"}], "2"], ",", 
      SuperscriptBox[
       RowBox[{"R", "[", 
        RowBox[{"t", ",", "r"}], "]"}], "2"], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"R", "[", 
         RowBox[{"t", ",", "r"}], "]"}], "2"], 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InvMet", "=", 
   RowBox[{"Met", "//", "Inverse"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coords", "=", 
   RowBox[{"{", 
    RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"InvMet", "\[LeftDoubleBracket]", 
     RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"t", ",", "r"}], "]"}], ",", 
      RowBox[{
      "Coords", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
     "]"}], 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"t", ",", "r"}], "]"}], ",", 
      RowBox[{
      "Coords", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
     "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.951451275415723*^9, 3.9514513309743195`*^9}, {
  3.951451417616703*^9, 3.9514515003128276`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"fe5245b7-b0b3-41ca-a538-50a6df81e584"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["R", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "r"}], "]"}], "2"], 
   SuperscriptBox[
    RowBox[{"B", "[", 
     RowBox[{"t", ",", "r"}], "]"}], "2"]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["R", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "r"}], "]"}], "2"], 
   SuperscriptBox[
    RowBox[{"A", "[", 
     RowBox[{"t", ",", "r"}], "]"}], "2"]]}]], "Output",
 CellChangeTimes->{{3.951451491025605*^9, 3.951451500637622*^9}},
 CellLabel->"Out[8]=",ExpressionUUID->"06ed370d-5c12-4260-9d51-0b35b6a778d0"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.952770959973444*^9, 
  3.9527709622294536`*^9}},ExpressionUUID->"094ff886-b463-414f-96a9-\
7f67f75a99ea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "d", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       SqrtBox[
        RowBox[{
         RowBox[{"4", 
          SuperscriptBox["d", "2"], 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], "+", 
         RowBox[{"4", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "-", 
            SuperscriptBox["d", "2"]}], ")"}]}]}]]}], ")"}]}], "==", "d"}], 
   ",", "\[Theta]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9527722059534245`*^9, 3.9527723101699076`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"c0862f31-8173-44ad-92d9-7f47903773ff"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "ifun", 
   "\"Inverse functions are being used by \
\\!\\(\\*RowBox[{\\\"Solve\\\"}]\\), so some solutions may not be found; use \
Reduce for complete solution information.\"", 2, 8, 5, 26412250772580301778, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.9527722579394803`*^9, 3.952772310562101*^9}},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"20b99061-1bb3-4dde-8bd1-f623328860ff"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"ArcCos", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["a", "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"]}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"]}]], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", "\[Rule]", 
     RowBox[{"ArcCos", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["a", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["d", "2"]}]], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.952772258098572*^9, 3.952772310598097*^9}},
 CellLabel->"Out[8]=",ExpressionUUID->"295db9d5-94a3-45e5-b509-82fe844290d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "d", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
      SqrtBox[
       RowBox[{
        RowBox[{"4", 
         SuperscriptBox["d", "2"], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], "+", 
        RowBox[{"4", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "-", 
           SuperscriptBox["d", "2"]}], ")"}]}]}]]}], ")"}]}], ",", 
   "\[Theta]"}], "]"}]], "Input",
 CellChangeTimes->{{3.952772312433035*^9, 3.952772344464711*^9}, {
  3.952772404342258*^9, 3.9527724243544183`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"3fdd4bf0-a95b-40aa-8b08-88159b2451cf"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["a", "2"], " ", 
    SqrtBox[
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"]}], "-", 
       SuperscriptBox["d", "2"], "+", 
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], 
      SuperscriptBox["a", "2"]]], " ", 
    RowBox[{"EllipticE", "[", 
     RowBox[{"\[Theta]", ",", 
      FractionBox[
       SuperscriptBox["d", "2"], 
       SuperscriptBox["a", "2"]]}], "]"}]}], 
   SqrtBox[
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["a", "2"]}], "-", 
     SuperscriptBox["d", "2"], "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}]]], "+", 
  RowBox[{"d", " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.9527723985724764`*^9, 3.9527724247783985`*^9}},
 CellLabel->"Out[12]=",ExpressionUUID->"da6ea91e-c087-4e2e-a41a-44a9fb29e809"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Integrate", "[", " ", "]"}]], "Input",
 CellChangeTimes->{{3.9527735505836782`*^9, 
  3.9527735561279364`*^9}},ExpressionUUID->"616c7fe4-d8fc-400f-bc97-\
3351de027ccf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ArcCos", "[", 
    FractionBox["a", 
     RowBox[{"2", "d"}]], "]"}], "//", "Expand"}], "//", 
  "ExpToTrig"}]], "Input",
 CellChangeTimes->{{3.952775214275814*^9, 3.9527752331047664`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"1e2d992f-854d-4282-b40c-bc5baca83e66"],

Cell[BoxData[
 RowBox[{"ArcCos", "[", 
  FractionBox["a", 
   RowBox[{"2", " ", "d"}]], "]"}]], "Output",
 CellChangeTimes->{{3.9527752201328344`*^9, 3.9527752333287687`*^9}},
 CellLabel->"Out[15]=",ExpressionUUID->"428aead4-8013-43dc-99e1-212e1ffe6bbe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"ArcCos", "[", 
    FractionBox["a", 
     RowBox[{"2", " ", "d"}]], "]"}], "]"}], "/"}]], "Input",
 CellChangeTimes->{3.9527752273145247`*^9},
 NumberMarks->False,ExpressionUUID->"de11a5bf-077b-4e6d-ac64-91ae5425602e"],

Cell[BoxData[
 RowBox[{"ArcSec", "[", 
  FractionBox[
   RowBox[{"2", " ", "d"}], "a"], "]"}]], "Output",
 CellChangeTimes->{3.952775223463043*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"7a67993c-89c6-47e4-a97f-b0221b3762b9"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{949, 467},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>0.7 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"aa4e8b51-5a35-4943-817a-1987ec91679f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 312, 5, 68, "Title",ExpressionUUID->"3809e8e0-57dd-4b26-9013-38f376e2f55f"],
Cell[CellGroupData[{
Cell[917, 31, 158, 3, 47, "Section",ExpressionUUID->"d8e8aff3-e99d-4b81-bf97-6ac4982bc74d"],
Cell[1078, 36, 219, 3, 21, "Input",ExpressionUUID->"dc4cbbc2-31da-44ce-ad21-9f5073e17192"],
Cell[1300, 41, 199, 3, 24, "Text",ExpressionUUID->"4fe643eb-85ba-424d-b768-ad7d0d0584d7"],
Cell[1502, 46, 6554, 161, 207, "Input",ExpressionUUID->"2d5fad5e-fb27-43d9-9cde-d25daf209557"],
Cell[8059, 209, 1168, 33, 68, "Input",ExpressionUUID->"a1d9e19e-4511-4b10-8462-1ebc5efee8e2"],
Cell[9230, 244, 961, 19, 21, "Input",ExpressionUUID->"393e295e-c8aa-49d7-83eb-4983f5bf2987"],
Cell[CellGroupData[{
Cell[10216, 267, 1917, 47, 74, "Input",ExpressionUUID->"574e76b8-c3b5-44d3-b871-c8ef4e8156ca"],
Cell[12136, 316, 795, 21, 42, "Output",ExpressionUUID->"efd8c6c4-cf09-4b0e-863b-6f8a5f3c8aa1"]
}, Open  ]],
Cell[12946, 340, 628, 14, 21, "Input",ExpressionUUID->"9dd3f63a-05a6-4b55-b8c0-bca46b1714ad"],
Cell[13577, 356, 658, 19, 21, InheritFromParent,ExpressionUUID->"26173ebc-cdf5-47a0-98fd-6a2ce9336029"],
Cell[CellGroupData[{
Cell[14260, 379, 859, 23, 23, "Input",ExpressionUUID->"24a8ec03-00cd-44b7-ae52-c80f1d944b7d"],
Cell[15122, 404, 743, 20, 41, "Output",ExpressionUUID->"1dd908f5-5ad0-445b-b459-d1526f89ff19"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15902, 429, 342, 8, 21, "Input",ExpressionUUID->"e4584307-7681-4c95-a786-7dd131a4be4c"],
Cell[16247, 439, 224, 4, 23, "Output",ExpressionUUID->"8fa5b598-c87c-4f75-8c61-a0768baeab26"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16508, 448, 292, 7, 21, "Input",ExpressionUUID->"588df999-734e-434f-8258-962fb5b61a19"],
Cell[16803, 457, 315, 8, 38, "Output",ExpressionUUID->"763f961c-e4cd-4e51-87b6-73bde969b718"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17155, 470, 338, 8, 21, "Input",ExpressionUUID->"49804909-3ecf-4246-9df1-8ffc412df8d1"],
Cell[17496, 480, 223, 5, 24, "Output",ExpressionUUID->"e75dc144-75c8-48f1-841b-a09dd1f5b3a7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17756, 490, 343, 8, 21, "Input",ExpressionUUID->"688701b2-0545-4fad-a82c-0637cd31a761"],
Cell[18102, 500, 149, 2, 23, "Output",ExpressionUUID->"f367716d-2d69-42d1-b458-28602bad66d8"]
}, Open  ]],
Cell[18266, 505, 630, 15, 23, "Input",ExpressionUUID->"33c76fbe-4487-4750-a886-c678f7307425"],
Cell[18899, 522, 724, 23, 21, "Input",ExpressionUUID->"db2213db-fd7e-4fcd-b422-baceb060ebfb"],
Cell[CellGroupData[{
Cell[19648, 549, 523, 13, 23, "Input",ExpressionUUID->"294812fc-71cd-4a2d-ae96-a69cb2a0f75b"],
Cell[20174, 564, 1168, 39, 26, "Output",ExpressionUUID->"64f47890-b19b-4181-9b74-a235a4bda5d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21379, 608, 616, 16, 21, "Input",ExpressionUUID->"177315bd-852a-4cf1-a0c3-09c81cd4fe25"],
Cell[21998, 626, 7674, 210, 164, "Output",ExpressionUUID->"2c4298e9-c894-4f7a-9114-9f147eb0323f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29709, 841, 845, 22, 23, "Input",ExpressionUUID->"ce191f4f-9dbe-4706-8cc5-e4ad2ea12483"],
Cell[30557, 865, 287, 6, 24, "Output",ExpressionUUID->"91306234-84c0-4259-82f6-0b84d860e434"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30881, 876, 272, 6, 21, "Input",ExpressionUUID->"99454417-24e1-4a22-acb1-d8d77cb70fb0"],
Cell[31156, 884, 234, 6, 24, "Output",ExpressionUUID->"304cec1c-ef50-4b50-a8fa-f1fed969f834"]
}, Open  ]],
Cell[31405, 893, 437, 12, 25, "Text",ExpressionUUID->"4589ba25-46a8-4647-ab71-05984bf51536"],
Cell[31845, 907, 7066, 172, 193, "Input",ExpressionUUID->"07692e3d-b406-4d1d-9d44-b004b22dfefb"],
Cell[CellGroupData[{
Cell[38936, 1083, 534, 13, 23, "Input",ExpressionUUID->"a7fd4425-369f-46a0-9d8e-30c861747440"],
Cell[39473, 1098, 756, 23, 23, "Output",ExpressionUUID->"9fe04142-228a-4946-9510-9a7a1788a32b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40278, 1127, 225, 4, 47, "Section",ExpressionUUID->"792db1c6-1570-4888-9e66-ca8db693bd98"],
Cell[CellGroupData[{
Cell[40528, 1135, 2741, 62, 62, "Input",ExpressionUUID->"77b42885-5dbc-432a-9838-2a0e5f886a7e"],
Cell[43272, 1199, 8475, 227, 69, "Output",ExpressionUUID->"e45e9453-02b1-4210-b052-06bcc0deee89"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51784, 1431, 397, 8, 21, "Input",ExpressionUUID->"b79533e2-72b9-4f6a-9cdc-8572c29a5ed2"],
Cell[52184, 1441, 2981, 89, 43, "Output",ExpressionUUID->"ebf0d4a2-ec73-4f46-ba03-686ede5e1b47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55202, 1535, 2859, 61, 50, "Input",ExpressionUUID->"3b9b7b36-4e3c-4a0d-a046-90a3d8d1ee5f"],
Cell[58064, 1598, 4819, 139, 60, "Output",ExpressionUUID->"5674dbb4-f3cd-4900-a9be-2f31927ab918"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62920, 1742, 278, 6, 21, "Input",ExpressionUUID->"a5d95d35-5774-4bf8-8a9e-7127bdecb070"],
Cell[63201, 1750, 1213, 35, 43, "Output",ExpressionUUID->"2ac96fd8-4791-445b-b880-10f23bc4b078"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64451, 1790, 1031, 28, 37, "Input",ExpressionUUID->"91a8d7e2-a40c-4512-88dc-67327032eb43"],
Cell[65485, 1820, 299, 7, 39, "Output",ExpressionUUID->"23d6aeea-ad98-4893-8e71-9320cbe9dff4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65821, 1832, 857, 22, 23, "Input",ExpressionUUID->"d0acfae9-b31a-482f-bd7d-1dd646277dc9"],
Cell[66681, 1856, 1242, 39, 42, "Output",ExpressionUUID->"8ea370f8-17ef-4f93-88a3-460872c8e0ba"]
}, Open  ]],
Cell[67938, 1898, 748, 25, 32, "Input",ExpressionUUID->"1388bbce-3765-49fa-88b4-f55c4463fbdf"],
Cell[CellGroupData[{
Cell[68711, 1927, 1846, 55, 64, "Input",ExpressionUUID->"fe5245b7-b0b3-41ca-a538-50a6df81e584"],
Cell[70560, 1984, 858, 29, 42, "Output",ExpressionUUID->"06ed370d-5c12-4260-9d51-0b35b6a778d0"]
}, Open  ]],
Cell[71433, 2016, 154, 3, 21, "Input",ExpressionUUID->"094ff886-b463-414f-96a9-7f67f75a99ea"],
Cell[CellGroupData[{
Cell[71612, 2023, 780, 23, 33, "Input",ExpressionUUID->"c0862f31-8173-44ad-92d9-7f47903773ff"],
Cell[72395, 2048, 475, 11, 20, "Message",ExpressionUUID->"20b99061-1bb3-4dde-8bd1-f623328860ff"],
Cell[72873, 2061, 895, 27, 40, "Output",ExpressionUUID->"295db9d5-94a3-45e5-b509-82fe844290d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73805, 2093, 790, 23, 33, "Input",ExpressionUUID->"3fdd4bf0-a95b-40aa-8b08-88159b2451cf"],
Cell[74598, 2118, 1068, 33, 57, "Output",ExpressionUUID->"da6ea91e-c087-4e2e-a41a-44a9fb29e809"]
}, Open  ]],
Cell[75681, 2154, 192, 4, 21, "Input",ExpressionUUID->"616c7fe4-d8fc-400f-bc97-3351de027ccf"],
Cell[CellGroupData[{
Cell[75898, 2162, 315, 8, 32, "Input",ExpressionUUID->"1e2d992f-854d-4282-b40c-bc5baca83e66"],
Cell[76216, 2172, 254, 5, 35, "Output",ExpressionUUID->"428aead4-8013-43dc-99e1-212e1ffe6bbe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76507, 2182, 286, 7, 32, "Input",ExpressionUUID->"de11a5bf-077b-4e6d-ac64-91ae5425602e"],
Cell[76796, 2191, 226, 5, 37, "Output",ExpressionUUID->"7a67993c-89c6-47e4-a97f-b0221b3762b9"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

