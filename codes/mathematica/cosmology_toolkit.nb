(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42885,       1140]
NotebookOptionsPosition[     40667,       1092]
NotebookOutlinePosition[     41143,       1110]
CellTagsIndexPosition[     41100,       1107]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Cosmology Toolkit", "Title",
 CellChangeTimes->{{3.9158816405545917`*^9, 3.9158816420910916`*^9}, {
  3.915893349767639*^9, 3.915893351202422*^9}, {3.925358414652584*^9, 
  3.925358419471649*^9}, {3.9506531506292405`*^9, 
  3.9506531576101303`*^9}},ExpressionUUID->"3809e8e0-57dd-4b26-9013-\
38f376e2f55f"],

Cell[CellGroupData[{

Cell["I. GR Tools", "Section",
 CellChangeTimes->{{3.9506578847201943`*^9, 
  3.950657914193551*^9}},ExpressionUUID->"d8e8aff3-e99d-4b81-bf97-\
6ac4982bc74d"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.9506579995076585`*^9, 3.950658020615902*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"dc4cbbc2-31da-44ce-ad21-9f5073e17192"],

Cell["For full-blown curvature quantities", "Text",
 CellChangeTimes->{{3.951272340121393*^9, 3.951272350169123*^9}, 
   3.95127792021263*^9},ExpressionUUID->"4fe643eb-85ba-424d-b768-\
ad7d0d0584d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DiffGeom", "[", 
   RowBox[{"Met_", ",", "Coords_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Dim", ",", "Metric", ",", "InvMet", ",", "Christoff", ",", "Curv", ",", 
      "Ric", ",", "ScalRic", ",", "EinsTens"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Metric", "=", "Met"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Dim", "=", 
      RowBox[{"Length", "[", "Coords", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"InvMet", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Inverse", "[", "Met", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Christoff", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"InvMet", "[", 
              RowBox[{"[", 
               RowBox[{"\[Sigma]", ",", "\[Mu]"}], "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Met", "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Mu]", ",", "\[Beta]"}], "]"}], "]"}], ",", 
                 RowBox[{"Coords", "[", 
                  RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "+", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Met", "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Mu]", ",", "\[Alpha]"}], "]"}], "]"}], ",", 
                 RowBox[{"Coords", "[", 
                  RowBox[{"[", "\[Beta]", "]"}], "]"}]}], "]"}], "-", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Met", "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], ",", 
                 RowBox[{"Coords", "[", 
                  RowBox[{"[", "\[Mu]", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Mu]", ",", "1", ",", "Dim"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Sigma]", ",", "1", ",", "Dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "Dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Beta]", ",", "1", ",", "Dim"}], "}"}]}], "]"}], "//", 
       "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Curv", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Christoff", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j", ",", "l"}], "]"}], "]"}], ",", 
            RowBox[{"Coords", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "-", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Christoff", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
            RowBox[{"Coords", "[", 
             RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Christoff", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "j", ",", "l"}], "]"}], "]"}], " ", 
              RowBox[{"Christoff", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "s", ",", "k"}], "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"Christoff", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "j", ",", "k"}], "]"}], "]"}], " ", 
              RowBox[{"Christoff", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "s", ",", "l"}], "]"}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"s", ",", "1", ",", "Dim"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "Dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "Dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "Dim"}], "}"}]}], "]"}], "//", 
       "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ric", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Curv", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "i", ",", "l"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "Dim"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "Dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "Dim"}], "}"}]}], "]"}], "//", 
       "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ScalRic", "=", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"InvMet", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", 
          RowBox[{"Ric", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "Dim"}], "}"}]}], "]"}], "//", 
       "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"EinsTens", "=", 
      RowBox[{"Ric", "-", 
       RowBox[{
        FractionBox["1", "2"], "ScalRic", "*", "Met"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Christoffel\>\"", "->", "Christoff"}], ",", 
       RowBox[{"\"\<Riemann\>\"", "->", "Curv"}], ",", 
       RowBox[{"\"\<Ricci\>\"", "->", "Ric"}], ",", 
       RowBox[{"\"\<ScalarRic\>\"", "->", "ScalRic"}], ",", 
       RowBox[{"\"\<Einstein\>\"", "->", "EinsTens"}]}], "|>"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9506579236478205`*^9, 3.9506579390090494`*^9}, {
   3.9506580287237763`*^9, 3.9506580289432516`*^9}, {3.9510162459107437`*^9, 
   3.9510162853601975`*^9}, {3.951016503611042*^9, 3.9510165251165037`*^9}, 
   3.951268136202739*^9, {3.951272130069311*^9, 3.9512722283498697`*^9}, {
   3.951272288518876*^9, 3.951272296979701*^9}, {3.9533428620665255`*^9, 
   3.95334295240878*^9}, {3.9533429880277123`*^9, 3.9533429894885454`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"2d5fad5e-fb27-43d9-9cde-d25daf209557"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PerturbedCurvature", "[", 
   RowBox[{"Met_", ",", "Coords_", ",", "Order_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Dim", ",", "Metric", ",", "InvMet", ",", "Christoff", ",", "Curv", ",", 
      "Ric", ",", "ScalRic"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Metric", "=", "Met"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Dim", "=", 
      RowBox[{"Length", "[", "Coords", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"InvMet", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Inverse", "[", "Met", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Christoff", "=", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "2"}], " ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"InvMet", "[", 
                 RowBox[{"[", 
                  RowBox[{"\[Sigma]", ",", "\[Mu]"}], "]"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"Met", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Mu]", ",", "\[Beta]"}], "]"}], "]"}], ",", 
                    RowBox[{"Coords", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "+", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"Met", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Mu]", ",", "\[Alpha]"}], "]"}], "]"}], ",", 
                    RowBox[{"Coords", "[", 
                    RowBox[{"[", "\[Beta]", "]"}], "]"}]}], "]"}], "-", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"Met", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], ",", 
                    RowBox[{"Coords", "[", 
                    RowBox[{"[", "\[Mu]", "]"}], "]"}]}], "]"}]}], ")"}]}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"\[Mu]", ",", "1", ",", "Dim"}], "}"}]}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"\[Sigma]", ",", "1", ",", "Dim"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "1", ",", "Dim"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Beta]", ",", "1", ",", "Dim"}], "}"}]}], "]"}], "//", 
          "Simplify"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "Order"}], "}"}]}], "]"}], "//",
        "Normal"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Curv", "=", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"Christoff", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "l"}], "]"}], "]"}], ",", 
              RowBox[{"Coords", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"Christoff", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"Coords", "[", 
               RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "+", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Christoff", "[", 
                 RowBox[{"[", 
                  RowBox[{"s", ",", "j", ",", "l"}], "]"}], "]"}], " ", 
                RowBox[{"Christoff", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "s", ",", "k"}], "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"Christoff", "[", 
                 RowBox[{"[", 
                  RowBox[{"s", ",", "j", ",", "k"}], "]"}], "]"}], " ", 
                RowBox[{"Christoff", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "s", ",", "l"}], "]"}], "]"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"s", ",", "1", ",", "Dim"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "Dim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "Dim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "Dim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "1", ",", "Dim"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "Order"}], "}"}]}], "]"}], "//",
        "Normal"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ric", "=", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"Curv", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "i", ",", "l"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "Dim"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "Dim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "1", ",", "Dim"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "Order"}], "}"}]}], "]"}], "//",
        "Normal"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ScalRic", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"InvMet", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", 
             RowBox[{"Ric", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "Dim"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "Dim"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Epsilon]", ",", "0", ",", "Order"}], "}"}]}], "]"}], "//",
         "Normal"}], "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Metric\>\"", "->", "Metric"}], ",", 
       RowBox[{"\"\<InverseMetric\>\"", "->", "InvMet"}], ",", 
       RowBox[{"\"\<ChristoffelSymbols\>\"", "->", "Christoff"}], ",", 
       RowBox[{"\"\<RiemannTensor\>\"", "->", "Curv"}], ",", 
       RowBox[{"\"\<RicciTensor\>\"", "->", "Ric"}], ",", 
       RowBox[{"\"\<ScalarCurvature\>\"", "->", "ScalRic"}]}], "|>"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9512756057086782`*^9, 3.9512756107841206`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"07692e3d-b406-4d1d-9d44-b004b22dfefb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CurvatureComputations", "[", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "}"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], "]"}], "[", 
  "\"\<ChristoffelSymbols\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.9524000136863422`*^9, 3.9524000658114505`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"a7fd4425-369f-46a0-9d8e-30c861747440"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Cot", "[", "\[Theta]", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cot", "[", "\[Theta]", "]"}], ",", "0"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.9524000408118343`*^9, 3.952400066102517*^9}},
 CellLabel->"Out[54]=",ExpressionUUID->"9fe04142-228a-4946-9510-9a7a1788a32b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["II.  Scalar Perturbations", "Section",
 CellChangeTimes->{{3.9506581730482197`*^9, 3.9506581882873154`*^9}, {
  3.9512723698492336`*^9, 
  3.951272373076559*^9}},ExpressionUUID->"792db1c6-1570-4888-9e66-\
ca8db693bd98"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Coords", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Met", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", "\[Epsilon]", " ", 
            RowBox[{"C", "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
           RowBox[{
            FractionBox["2", "3"], "\[Epsilon]", " ", 
            RowBox[{"Laplacian", "[", 
             RowBox[{
              RowBox[{"\[CapitalEpsilon]", "[", 
               RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "Coords"}], 
             "]"}]}]}], ")"}], 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"i", ",", "j"}], "]"}]}], "+", 
        RowBox[{"2", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"\[Epsilon]", " ", 
              RowBox[{"\[CapitalEpsilon]", "[", 
               RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
             RowBox[{
             "Coords", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}], "]"}], ",", 
           RowBox[{
           "Coords", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
           "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Met", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.9512678759855485`*^9, 3.951268022228322*^9}, {
   3.951268225997279*^9, 3.9512682276837234`*^9}, {3.9512689240964146`*^9, 
   3.951269012541601*^9}, {3.9512695554726896`*^9, 3.9512696348175163`*^9}, {
   3.951269669849096*^9, 3.9512696878676615`*^9}, {3.951270683913165*^9, 
   3.9512707035443244`*^9}, {3.951270890014124*^9, 3.9512708997030544`*^9}, {
   3.9512712526829576`*^9, 3.951271256014741*^9}, {3.9512713515930557`*^9, 
   3.9512713893500333`*^9}, {3.95127148190153*^9, 3.951271482995021*^9}, {
   3.9512723897146635`*^9, 3.951272401789083*^9}, {3.9512754420540867`*^9, 
   3.9512755213912125`*^9}, {3.9512756765987444`*^9, 
   3.9512756784399796`*^9}, {3.9512761984956207`*^9, 3.951276227059444*^9}, 
   3.9512766417674055`*^9, {3.9512766930302444`*^9, 3.9512766932194686`*^9}, {
   3.951276897832077*^9, 3.9512768999082365`*^9}, {3.9512774566118035`*^9, 
   3.9512775249274516`*^9}, {3.9512776222551823`*^9, 3.9512776270484*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"77b42885-5dbc-432a-9838-2a0e5f886a7e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{"C", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{
           SuperscriptBox["\[CapitalEpsilon]", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
         RowBox[{
          FractionBox["2", "3"], " ", "\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "0", ",", "2"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "2", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"2", ",", "0", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]},
     {
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{"C", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{
           SuperscriptBox["\[CapitalEpsilon]", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
         RowBox[{
          FractionBox["2", "3"], " ", "\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "0", ",", "2"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "2", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"2", ",", "0", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]},
     {
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{"C", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{
           SuperscriptBox["\[CapitalEpsilon]", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
         RowBox[{
          FractionBox["2", "3"], " ", "\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "0", ",", "2"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "2", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
            RowBox[{
             SuperscriptBox["\[CapitalEpsilon]", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"2", ",", "0", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ")"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9512724238389378`*^9, {3.9512754995724063`*^9, 3.9512755217977777`*^9}, 
   3.9512756201627884`*^9, 3.9512756795037885`*^9, 3.9512759811883326`*^9, 
   3.951276098168895*^9, {3.9512762024600134`*^9, 3.95127622744137*^9}, {
   3.951276645998161*^9, 3.951276670449132*^9}, 3.9512767013537765`*^9, 
   3.9512769007704625`*^9, 3.9512775256139445`*^9, 3.951277572219057*^9, 
   3.9512776274597816`*^9, 3.951277855538099*^9, 3.9513375530592637`*^9},
 CellLabel->
  "Out[9]//MatrixForm=",ExpressionUUID->"e45e9453-02b1-4210-b052-\
06bcc0deee89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PerturbedCurvature", "[", 
    RowBox[{"Met", ",", "Coords", ",", "1"}], "]"}], "[", 
   "\"\<ScalarCurvature\>\"", "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.951277535294801*^9, 3.9512775424325647`*^9}, {
  3.951277594924122*^9, 3.9512776149703856`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"b79533e2-72b9-4f6a-9cdc-8572c29a5ed2"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"4", " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", 
       RowBox[{
        SuperscriptBox["C", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "2"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[CapitalEpsilon]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "4"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
      RowBox[{"3", " ", 
       RowBox[{
        SuperscriptBox["C", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2", ",", "2"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[CapitalEpsilon]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "4", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
      RowBox[{"3", " ", 
       RowBox[{
        SuperscriptBox["C", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0", ",", "2"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["\[CapitalEpsilon]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[CapitalEpsilon]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"4", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ")"}]}], 
   RowBox[{"3", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "t", "]"}], "2"]}]]}]], "Output",
 CellChangeTimes->{{3.951277557763446*^9, 3.951277632380413*^9}, 
   3.951277859340675*^9, 3.9513375650555916`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"ebf0d4a2-ec73-4f46-ba03-686ede5e1b47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Coords", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Met", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], 
      RowBox[{"(", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", "\[Epsilon]", " ", 
             RowBox[{"\[Zeta]", "[", 
              RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ")"}], 
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}], "+", 
         RowBox[{"2", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", " ", 
               RowBox[{"F", "[", 
                RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
              RowBox[{
              "Coords", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", 
            RowBox[{
            "Coords", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}]}], "]"}]}]}], ")"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Met", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.9512678759855485`*^9, 3.951268022228322*^9}, {
   3.951268225997279*^9, 3.9512682276837234`*^9}, {3.9512689240964146`*^9, 
   3.951269012541601*^9}, {3.9512695554726896`*^9, 3.9512696348175163`*^9}, {
   3.951269669849096*^9, 3.9512696878676615`*^9}, {3.951270683913165*^9, 
   3.9512707035443244`*^9}, {3.951270890014124*^9, 3.9512708997030544`*^9}, {
   3.9512712526829576`*^9, 3.951271256014741*^9}, {3.9512713515930557`*^9, 
   3.9512713893500333`*^9}, {3.95127148190153*^9, 3.951271482995021*^9}, {
   3.9512723897146635`*^9, 3.951272401789083*^9}, {3.9512754420540867`*^9, 
   3.9512755213912125`*^9}, {3.9512756765987444`*^9, 
   3.9512756784399796`*^9}, {3.9512761984956207`*^9, 3.951276227059444*^9}, 
   3.9512766417674055`*^9, {3.9512766930302444`*^9, 3.9512766932194686`*^9}, {
   3.951276897832077*^9, 3.9512768999082365`*^9}, {3.9512774566118035`*^9, 
   3.9512775249274516`*^9}, {3.9512776222551823`*^9, 
   3.9512776578208523`*^9}, {3.951277698524556*^9, 3.951277736591169*^9}, {
   3.9512778761736684`*^9, 3.951277876513246*^9}, {3.9512779866961813`*^9, 
   3.9512779869147463`*^9}, {3.951278376929799*^9, 3.951278387294264*^9}, {
   3.9512784881433587`*^9, 3.951278488394503*^9}, {3.9512795603938026`*^9, 
   3.9512795770730314`*^9}, {3.9513375296497345`*^9, 3.9513375304245644`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"3b9b7b36-4e3c-4a0d-a046-90a3d8d1ee5f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{"\[Zeta]", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{
           SuperscriptBox["F", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["F", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["F", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]},
     {
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["F", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{"\[Zeta]", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{
           SuperscriptBox["F", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["F", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]},
     {
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["F", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["F", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{"\[Zeta]", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
         RowBox[{"2", " ", "\[Epsilon]", " ", 
          RowBox[{
           SuperscriptBox["F", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.951278388081688*^9, 3.951278488997525*^9, {3.9512795663258953`*^9, 
   3.951279577292489*^9}, {3.951337544151431*^9, 3.951337565265086*^9}},
 CellLabel->
  "Out[13]//MatrixForm=",ExpressionUUID->"5674dbb4-f3cd-4900-a9be-\
2f31927ab918"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PerturbedCurvature", "[", 
    RowBox[{"Met", ",", "Coords", ",", "1"}], "]"}], "[", 
   "\"\<ScalarCurvature\>\"", "]"}], "//", "Simplify"}]], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"a5d95d35-5774-4bf8-8a9e-7127bdecb070"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"4", " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Zeta]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["\[Zeta]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["\[Zeta]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"a", "[", "t", "]"}], "2"]]}]], "Output",
 CellChangeTimes->{3.951277977816276*^9, 3.9512780317574763`*^9, 
  3.9512783992559133`*^9, 3.9512784927189255`*^9, 3.9512795978586426`*^9, 
  3.9513375673346753`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"2ac96fd8-4791-445b-b880-10f23bc4b078"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{898, 467},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>0.7 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"aa4e8b51-5a35-4943-817a-1987ec91679f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 312, 5, 68, "Title",ExpressionUUID->"3809e8e0-57dd-4b26-9013-38f376e2f55f"],
Cell[CellGroupData[{
Cell[917, 31, 158, 3, 47, "Section",ExpressionUUID->"d8e8aff3-e99d-4b81-bf97-6ac4982bc74d"],
Cell[1078, 36, 219, 3, 21, "Input",ExpressionUUID->"dc4cbbc2-31da-44ce-ad21-9f5073e17192"],
Cell[1300, 41, 199, 3, 24, "Text",ExpressionUUID->"4fe643eb-85ba-424d-b768-ad7d0d0584d7"],
Cell[1502, 46, 6553, 161, 220, "Input",ExpressionUUID->"2d5fad5e-fb27-43d9-9cde-d25daf209557"],
Cell[8058, 209, 7066, 172, 193, "Input",ExpressionUUID->"07692e3d-b406-4d1d-9d44-b004b22dfefb"],
Cell[CellGroupData[{
Cell[15149, 385, 534, 13, 23, "Input",ExpressionUUID->"a7fd4425-369f-46a0-9d8e-30c861747440"],
Cell[15686, 400, 756, 23, 23, "Output",ExpressionUUID->"9fe04142-228a-4946-9510-9a7a1788a32b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16491, 429, 225, 4, 47, "Section",ExpressionUUID->"792db1c6-1570-4888-9e66-ca8db693bd98"],
Cell[CellGroupData[{
Cell[16741, 437, 2741, 62, 62, "Input",ExpressionUUID->"77b42885-5dbc-432a-9838-2a0e5f886a7e"],
Cell[19485, 501, 8475, 227, 69, "Output",ExpressionUUID->"e45e9453-02b1-4210-b052-06bcc0deee89"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27997, 733, 397, 8, 21, "Input",ExpressionUUID->"b79533e2-72b9-4f6a-9cdc-8572c29a5ed2"],
Cell[28397, 743, 2981, 89, 57, "Output",ExpressionUUID->"ebf0d4a2-ec73-4f46-ba03-686ede5e1b47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31415, 837, 2859, 61, 50, "Input",ExpressionUUID->"3b9b7b36-4e3c-4a0d-a046-90a3d8d1ee5f"],
Cell[34277, 900, 4819, 139, 60, "Output",ExpressionUUID->"5674dbb4-f3cd-4900-a9be-2f31927ab918"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39133, 1044, 278, 6, 21, "Input",ExpressionUUID->"a5d95d35-5774-4bf8-8a9e-7127bdecb070"],
Cell[39414, 1052, 1213, 35, 43, "Output",ExpressionUUID->"2ac96fd8-4791-445b-b880-10f23bc4b078"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

